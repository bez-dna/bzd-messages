syntax = "proto3";
package bzd.messages.topics;

service TopicsService {
    rpc GetTopics(GetTopicsRequest) returns (GetTopicsResponse);
    rpc GetTopic(GetTopicRequest) returns (GetTopicResponse);

    rpc CreateTopic(CreateTopicRequest) returns (CreateTopicResponse);
    rpc GetUserTopics(GetUserTopicsRequest) returns (GetUserTopicsResponse);

    rpc GetTopicsUsers(GetTopicsUsersRequest) returns (GetTopicsUsersResponse);
    rpc CreateTopicUser(CreateTopicUserRequest)
        returns (CreateTopicUserResponse);
    rpc UpdateTopicUser(UpdateTopicUserRequest)
        returns (UpdateTopicUserResponse);
    rpc DeleteTopicUser(DeleteTopicUserRequest)
        returns (DeleteTopicUserResponse);
}

message CreateTopicRequest {
    optional string title = 101;
    optional string user_id = 102;
}

message CreateTopicResponse {
    optional string topic_id = 101;
}

message Topic {
    optional string topic_id = 101;
    optional string title = 102;
    optional string user_id = 103;
}

message GetTopicsRequest {
    repeated string topic_ids = 101;
}

message GetTopicsResponse {
    repeated Topic topics = 501;
}

message GetTopicRequest {
    optional string topic_id = 101;
}

message GetTopicResponse {
    optional Topic topic = 501;
}

message GetUserTopicsRequest {
    optional string user_id = 101;
}

message GetUserTopicsResponse {
    repeated string topic_ids = 101;
}

message GetTopicsUsersRequest {
    optional string current_user_id = 100;
    repeated string topic_ids = 101;
}

message GetTopicsUsersResponse {
    repeated TopicUser topics_users = 501;

    message TopicUser {
        optional string topic_user_id = 101;
        optional string topic_id = 102;
        optional string user_id = 103;
        optional Timing timing = 104;
        optional Rate rate = 105;
    }
}

message CreateTopicUserRequest {
    optional string current_user_id = 100;
    optional string topic_id = 101;
}

message CreateTopicUserResponse {
    optional string topic_user_id = 101;
}

message UpdateTopicUserRequest {
    optional string current_user_id = 100;
    optional string topic_user_id = 101;
    optional Timing timing = 102;
    optional Rate rate = 103;
}

message UpdateTopicUserResponse {}

message DeleteTopicUserRequest {
    optional string current_user_id = 100;
    optional string topic_user_id = 101;
}

message DeleteTopicUserResponse {}

enum Timing {
    TIMING_UNKNOWN = 0;
    TIMING_INSTANT = 1;
    TIMING_WEEKDAYS = 2;
    TIMING_WEEKENDS = 3;
}

enum Rate {
    RATE_UNKNOWN = 0;
    RATE_Q = 1;
    RATE_QW = 2;
    RATE_QD = 3;
}
